import{a as G}from"./chunk-62JJFTRD.js";import{b as N,c as W,d as L,e as D,f as R,g as B,l as q,m as H}from"./chunk-3BKCMDI7.js";import{Ea as o,G as m,Ga as _,H as v,Ha as S,Ia as b,Ja as f,Ka as h,Oa as w,W as c,_ as I,a as A,b as P,ba as z,db as y,eb as E,ga as x,gb as O,ka as p,lb as k,mb as V,oa as r,ob as F,pa as n,pb as j,qa as u,sb as T,ta as M,va as g,wa as l}from"./chunk-XY36RKC2.js";var U=(s,e)=>["/formulario-actividad",s,e,"nuevo"];function Y(s,e){if(s&1){let i=M();r(0,"div")(1,"h3"),o(2,"Actualizar Actividad"),n(),r(3,"form",6),g("ngSubmit",function(){m(i);let t=l();return v(t.guardarActualizacion())}),r(4,"label",7),o(5,"Nombre"),n(),r(6,"input",8),h("ngModelChange",function(t){m(i);let d=l();return f(d.actividadActualizada.nombre,t)||(d.actividadActualizada.nombre=t),v(t)}),n(),r(7,"label",9),o(8,"Descripci\xF3n"),n(),r(9,"textarea",10),h("ngModelChange",function(t){m(i);let d=l();return f(d.actividadActualizada.descripcion,t)||(d.actividadActualizada.descripcion=t),v(t)}),n(),r(10,"label",11),o(11,"Hora de inicio"),n(),r(12,"input",12),h("ngModelChange",function(t){m(i);let d=l();return f(d.actividadActualizada.horaInicio,t)||(d.actividadActualizada.horaInicio=t),v(t)}),n(),r(13,"label",13),o(14,"Hora de fin"),n(),r(15,"input",14),h("ngModelChange",function(t){m(i);let d=l();return f(d.actividadActualizada.horaFin,t)||(d.actividadActualizada.horaFin=t),v(t)}),n(),r(16,"button",15),o(17,"Guardar cambios"),n(),r(18,"button",16),g("click",function(){m(i);let t=l();return v(t.cancelarActualizacion())}),o(19,"Cancelar"),n()(),u(20,"hr"),n()}if(s&2){let i=l();c(6),b("ngModel",i.actividadActualizada.nombre),c(3),b("ngModel",i.actividadActualizada.descripcion),c(3),b("ngModel",i.actividadActualizada.horaInicio),c(3),b("ngModel",i.actividadActualizada.horaFin)}}function J(s,e){if(s&1){let i=M();r(0,"div")(1,"h3"),o(2),n(),r(3,"p")(4,"strong"),o(5,"Nombre:"),n(),o(6),n(),r(7,"p")(8,"strong"),o(9,"Descripci\xF3n:"),n(),o(10),n(),r(11,"p")(12,"strong"),o(13,"Horario:"),n(),o(14),n(),r(15,"button",18),g("click",function(){let t=m(i).$implicit,d=l(2);return v(d.eliminarActividad(t.id))}),u(16,"i",19),o(17," Eliminar "),n(),r(18,"button",20),g("click",function(){let t=m(i).$implicit,d=l(2);return v(d.actualizarActividad(t))}),u(19,"i",21),o(20," Actualizar "),n(),r(21,"button",22),g("click",function(t){let d=m(i).$implicit,C=l(2);return v(C.verArchivos(d.id,t))}),u(22,"i",23),o(23," Ver Archivos "),n(),u(24,"hr"),n()}if(s&2){let i=e.$implicit;c(2),_("Actividad ",i.id,""),c(4),_(" ",i.nombre,""),c(4),_(" ",i.descripcion,""),c(4),S(" ",i.horaInicio," a ",i.horaFin,"")}}function Q(s,e){if(s&1&&(r(0,"div"),x(1,J,25,5,"div",17),n()),s&2){let i=l();c(),p("ngForOf",i.actividades)}}var K=class s{constructor(e,i,a){this.actividadService=e;this.route=i;this.router=a}actividades=[];viajePrevistoId;itinerarioId;actividadActualizada={id:0,viajePrevistoId:0,itinerarioId:0,tipoActividadId:0,actividadDisponibleId:void 0,nombre:"",descripcion:"",horaInicio:"",horaFin:""};ngOnInit(){this.route.paramMap.subscribe(e=>{let i=e.get("viajePrevistoId"),a=e.get("itinerarioId");i&&a&&(this.viajePrevistoId=+i,this.itinerarioId=+a,this.cargarActividades(),this.resetearFormulario())})}cargarActividades(){!this.viajePrevistoId||!this.itinerarioId||this.actividadService.getByViajeYItinerario(this.viajePrevistoId,this.itinerarioId).subscribe({next:e=>{console.log("Actividades cargadas:",e),this.actividades=e,console.log("N\xFAmero de actividades:",this.actividades.length)},error:e=>console.error("Error cargando actividades:",e)})}agregarActividad(){if(!this.viajePrevistoId||!this.itinerarioId)return;let e=P(A({},this.actividadActualizada),{viajePrevistoId:this.viajePrevistoId,itinerarioId:this.itinerarioId});this.actividadService.create(e).subscribe({next:i=>{this.actividades.push(i),this.resetearFormulario()},error:i=>console.error("Error creando actividad:",i)})}eliminarActividad(e){this.actividadService.delete(e).subscribe({next:()=>{this.actividades=this.actividades.filter(i=>i.id!==e)},error:i=>console.error("Error eliminando actividad:",i)})}actualizarActividad(e){this.actividadActualizada=A({},e),console.log("Actividad lista para actualizar:",this.actividadActualizada)}guardarActualizacion(){this.actividadService.update(this.actividadActualizada.id,this.actividadActualizada).subscribe({next:()=>{console.log("Actividad actualizada correctamente"),this.cargarActividades(),this.resetearFormulario()},error:e=>console.error("Error actualizando actividad:",e)})}cancelarActualizacion(){this.resetearFormulario()}volverAItinerarios(){console.log("Volver a itinerarios:",this.viajePrevistoId),this.router.navigate(["/itinerarios",this.viajePrevistoId])}verArchivos(e,i){if(console.log("CLICK detectado - ID:",e),!e)return;i.stopPropagation();let{viajePrevistoId:a,itinerarioId:t}=this.route.snapshot.params,d=["viajes-previstos",a,"itinerarios",t,"actividades",e,"archivos"];console.log("Navegando a URL:",d.join("/")),this.router.navigate(d).catch(C=>{console.error("Error en navegaci\xF3n:",C)})}consoleLogTest(e){console.log("CLICK detectado - ID:",e)}resetearFormulario(){this.actividadActualizada={id:0,viajePrevistoId:this.viajePrevistoId,itinerarioId:this.itinerarioId,tipoActividadId:0,actividadDisponibleId:void 0,nombre:"",descripcion:"",horaInicio:"",horaFin:""}}static \u0275fac=function(i){return new(i||s)(I(G),I(V),I(F))};static \u0275cmp=z({type:s,selectors:[["app-actividades-itinerarios"]],decls:12,vars:7,consts:[[1,"contenedor"],[1,"btn-agregar",3,"routerLink"],[1,"fa","fa-plus-circle"],[4,"ngIf"],[3,"click"],[1,"fa","fa-arrow-left"],[3,"ngSubmit"],["for","nombre"],["type","text","id","nombre","name","nombre","required","",3,"ngModelChange","ngModel"],["for","descripcion"],["id","descripcion","name","descripcion",3,"ngModelChange","ngModel"],["for","horaInicio"],["type","time","id","horaInicio","name","horaInicio","required","",3,"ngModelChange","ngModel"],["for","horaFin"],["type","time","id","horaFin","name","horaFin","required","",3,"ngModelChange","ngModel"],["type","submit",1,"btn-guardar"],["type","button",1,"btn-cancelar",3,"click"],[4,"ngFor","ngForOf"],[1,"btn-eliminar",3,"click"],[1,"fa","fa-trash"],[1,"btn-actualizar",3,"click"],[1,"fa","fa-edit"],[1,"btn-ver-archivos",3,"click"],[1,"fa","fa-folder-open"]],template:function(i,a){i&1&&(r(0,"div",0)(1,"h2"),o(2),n(),r(3,"button",1),u(4,"i",2),o(5,` A\xF1adir Actividad
`),n(),u(6,"hr"),x(7,Y,21,4,"div",3)(8,Q,2,1,"div",3),r(9,"button",4),g("click",function(){return a.volverAItinerarios()}),u(10,"i",5),o(11," Volver a Itinerarios "),n()()),i&2&&(c(2),_("Actividades para el itinerario ",a.itinerarioId,""),c(),p("routerLink",w(4,U,a.viajePrevistoId,a.itinerarioId)),c(4),p("ngIf",a.actividadActualizada==null?null:a.actividadActualizada.id),c(),p("ngIf",!(a.actividadActualizada!=null&&a.actividadActualizada.id)))},dependencies:[O,y,E,k,H,B,N,W,L,q,R,D,T,j],styles:['@charset "UTF-8";.contenedor[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:2rem;background:#fdfdfd;border-radius:12px;box-shadow:0 4px 10px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;color:#3f51b5;margin-bottom:1.5rem}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:2rem}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.3rem}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.6rem;border:1px solid #ccc;border-radius:8px;font-size:1rem}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:.8rem;border:none;border-radius:8px;font-size:1rem;cursor:pointer;transition:background-color .3s ease;margin-top:1rem}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#45a049}form[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#aaa;cursor:not-allowed}h3[_ngcontent-%COMP%]{color:#607d8b;margin-bottom:.5rem}p[_ngcontent-%COMP%]{margin:.3rem 0}button[_ngcontent-%COMP%]{margin-right:1rem;margin-top:.5rem;padding:.5rem 1rem;border-radius:8px;border:none;font-size:.9rem;cursor:pointer;transition:background-color .3s ease}button.btn-eliminar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}button.btn-eliminar[_ngcontent-%COMP%]:hover{background-color:#e53935}button.btn-actualizar[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff}button.btn-actualizar[_ngcontent-%COMP%]:hover{background-color:#1976d2}button.btn-agregar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}button.btn-agregar[_ngcontent-%COMP%]:hover{background-color:#45a049}button[_ngcontent-%COMP%]:last-of-type{display:block;margin:2rem auto 0;background-color:#9c27b0;color:#fff}button[_ngcontent-%COMP%]:last-of-type:hover{background-color:#7b1fa2}']})};export{K as ActividadesItinerariosComponent};
